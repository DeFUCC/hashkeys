<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>#Key test</title>
  <script type="importmap"> { "imports": { "vue": "https://esm.sh/vue" } } </script>
</head>

<body>
  <div id="app" style="display:flex; flex-direction: column; gap: 1em;">
    <h1>HashKey Minimal HTML test</h1>
    <h3>Type in a 8+ characters passphrase</h3>
    <input type="text" id="input" style="width:80svw;">
    <button id="login" disabled>LOGIN</button>
    <button id="get-key" disabled>GET KEY</button>
    <h4 id="id"></h4>
    <h4 id="master"></h4>

  </div>
  <script type="module">
    import { ref, watch } from 'vue'
    import auth from '../lib/index.js'

    document.getElementById('get-key').addEventListener('click', async e => { document.getElementById('master').innerHTML = await auth.getMasterKey() })

    document.getElementById('input').addEventListener('input', e => { if (e.target.value) { document.getElementById('login').disabled = false } })

    document.getElementById('login').addEventListener('click', e => {
      auth.login(document.getElementById('input').value)
    })

    watch(auth, async ({ authenticated, identity }) => {
      if (authenticated) {
        document.getElementById('id').innerHTML = identity
        document.getElementById('get-key').disabled = false

      }
    })

  </script>
</body>

</html>